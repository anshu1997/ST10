<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>Main</title>

		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.2/papaparse.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

		<link rel="shortcut icon" href="../favicon.ico"> 
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		<link rel="stylesheet" type="text/css" href="css/component.css" />
		<script src="js/modernizr.custom.js"></script>
		<script src="js/nlform.js"></script>
		<style type="text/css">
			.card{
				border: 0.1rem solid black;
				border-radius: 1.5rem;
				width: 18rem;
				float: left;
				margin:0.5rem 0.1rem 0.1rem 0.1rem;
				padding: 1rem;
			}
		</style>
	</head>
	<body class="nl-blurred">
		<script>
			$.ajax({
				type: "GET",
				url: "./sachin.csv",
				success: function (data) {
					var st=Papa.parse(data);
					st=st.data;
					//To get number of rows
					/*var size = Object.keys(st).length;
					Starting from st[1], 463 is the last index
					12 columns*/

					//Getting Opponent names
					var opponents = st.map(function(value,index) { return value[5]; });
					//opponents.shift();
					opponents = [...new Set(opponents)];
					opponents=[...(opponents)].sort();
					//len is 15
					var i;
					var base=$('#oppinput');
					for(i=1;i<16;i++){
						opponents[i] = opponents[i].substr(2);
						var sel=$('<option value=""></option>');
						sel.append(opponents[i]);
						sel.val(opponents[i]);
						base.append(sel);
					}

					//Getting stadium names
					opponents = st.map(function(value,index) { return value[6]; });
					//opponents.shift();
					opponents = [...new Set(opponents)];
					opponents=[...(opponents)].sort();
					//len is 90 i.e. index goes till 89
					var i;
					var base=$('#stadinput');
					for(i=0;i<90;i++){
						var sel=$('<option value=""></option>');
						sel.append(opponents[i]);
						sel.val(opponents[i]);
						base.append(sel);
					}

					//Getting dates
					var dates=[];
					var i;
					for(i=1;i<464;i++){
						dates[i-1]=st[i][7].split(" ")[2];
					}
					dates = [...new Set(dates)];
					dates=[...(dates)].sort();
					//alert(dates.length);Goes till 0-23
					var base=$('#dateinput');
					for(i=0;i<24;i++){
						var sel=$('<option value=""></option>');
						sel.append(dates[i]);
						sel.val(dates[i]);
						base.append(sel);
					}  
				} 
			});


			function arrayToTable(tableData,i) {
				var root=$('#output');
				var rowd=tableData[i];

				var table=$('<div class="card" ></div>');
				var head=$('<h4 class="card-title text-white"></h4>');
				head.append(tableData[i][7]);
				table.append(head);

				var row = $('<div class="card-body"></div>');
				$(rowd).each(function (j, cellData) {
						if(j!=7){
							row.append(tableData[0][j]+" : "+cellData +'<br />');
						} 
					});
				table.append(row);

				var foot=$('<div class="card-footer">Footer</div>');         
				table.append(foot);
				root.append(table);
				return root;
			}

			function display(){
				//alert("Triggered");
				$("#output div").remove(); 
				var search1=$('#oppinput').val();
				var search2=$('#stadinput').val();
				var search3=$('#runsinput').val();
				var search4=$('#dateinput').val();
				if((search1=="")&&(search2=="")&&(search3=="")&&(search4=="")){
					alert("Please select atleast one of the options");
				}
				else{
					$.ajax({
						type: "GET",
						url: "https://github.com/anshu1997/ST10/blob/master/sachin.csv",
						success: function (data) {
							var st=Papa.parse(data);
							st=st.data;
							if((search1!="")&&(search2!="")&&(search3!="")&&(search4!="")){
								var i;//5607
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									var test4=st[i][7].split(" ")[2];
									var trun=parseInt(st[i][0]);
										if(!isNaN(trun)){
											if((trun>=search3)&&(search1==test1)&&(search2==st[i][6])&&(search4==test4)){
											arrayToTable(st,i);
										}
									}
								}
							}
							else if((search1!="")&&(search2!="")&&(search3!="")){
								var i;//560
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if((trun>=search3)&&(search1==test1)&&(search2==st[i][6])){
											arrayToTable(st,i);
										}
									}
								}
							}
							else if((search1!="")&&(search3!="")&&(search4!="")){
								var i;//507
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									var test4=st[i][7].split(" ")[2];
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if((trun>=search3)&&(search1==test1)&&(search4==test4)){
											arrayToTable(st,i);
										}
								}
							}
							}
							else if((search2!="")&&(search3!="")&&(search4!="")){
								var i;//607
								for(i=1;i<464;i++){
									var test4=st[i][7].split(" ")[2];
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if((trun>=search3)&&(search2==st[i][6])&&(search4==test4)){
											arrayToTable(st,i);
										}
								}
							}
							}
							else if((search2!="")&&(search1!="")&&(search4!="")){
								var i;//567
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									var test4=st[i][7].split(" ")[2];
									if((search1==test1)&&(search2==st[i][6])&&(search4==test4)){
											arrayToTable(st,i);
									}
							}
							}
							else if((search1!="")&&(search2!="")){
								var i;//56
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									if((search1==test1)&&(search2==st[i][6])){
											arrayToTable(st,i);
									}
								}
							}
							else if((search1!="")&&(search3!="")){
								var i;//50
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if((trun>=search3)&&(search1==test1)){
											arrayToTable(st,i);
										}
								}
							}
							}
							else if((search1!="")&&(search4!="")){
								var i;//57
								for(i=1;i<464;i++){
									var test1 = st[i][5].substr(2);
									var test4=st[i][7].split(" ")[2];
									if((test4==search4)&&(search1==test1)){
											arrayToTable(st,i);
								}
							}
							}
							else if((search3!="")&&(search2!="")){
								var i;//60
								for(i=1;i<464;i++){
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if((trun>=search3)&&(search2==st[i][6])){
											arrayToTable(st,i);
										}
								}
							}
							}
							else if((search4!="")&&(search2!="")){
								var i;//67
								for(i=1;i<464;i++){
									var test4=st[i][7].split(" ")[2];
									if((search4==test4)&&(search2==st[i][6])){
										arrayToTable(st,i);
									}
								}
							}
							else if((search4!="")&&(search3!="")){
								var i;//07
								for(i=1;i<464;i++){
									var test4=st[i][7].split(" ")[2];
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if((trun>=search3)&&(search4==test4)){
											arrayToTable(st,i);
										}
								}
							}
							}
							else if((search1!="")){
								var i;//5
								for(i=1;i<464;i++){
									var test = st[i][5].substr(2);
									if(search1==test){
										arrayToTable(st,i);
									}
								}
							}
							else if((search2!="")){
								var i;//6
								for(i=1;i<464;i++){
									//alert(st[i][6]);
									if(search2==st[i][6]){
										//alert("Trigg");
										arrayToTable(st,i);
									}
								}
							}
							else if((search3!="")){
								var i;//0
								for(i=1;i<464;i++){
									var trun=parseInt(st[i][0]);
									if(!isNaN(trun)){
											if(trun>=search3){
											arrayToTable(st,i);
										}
								}
							}
							}
							else{
								var i;//7
								for(i=1;i<464;i++){
									var test4=st[i][7].split(" ")[2];
									if(search4==test4){
										arrayToTable(st,i);
									}
								}
							}
							
						}
					});
				}  
			}
		</script>


		<div class="container demo-1">
			<!-- Top Navigation -->
			<div class="codrops-top clearfix">
			</div>

			<header>
				<h1>Sachin <span>Playing it my way</span></h1>	
			</header>
			<div class="main clearfix">
				<form id="nl-form" class="nl-form" method="post">
					Instances when Sachin <br />scored more than
					<input type="number" id="runsinput"> 
					<br />against 
					<select id="oppinput">
						<option label="" selected></option>
					</select>
					<br />in 
					<select id="stadinput">
						<option label="" selected></option>
					</select>
					stadium
					<br />in the year  
					<select id="dateinput">
						<option label="" selected></option>
					</select>
					<div class="nl-submit-wrap">
						<button type="button" class="nl-submit" id="submit" onclick="display()">Go</button>
					</div>
					<div class="nl-overlay"></div>
				</form>
				<div id="output">
				</div>
			</div>
			
		</div><!-- /container -->
		
	</body>
</html>
